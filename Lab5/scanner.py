fileName = "log.txt"    # this is the logs from a malicious program
renameCount = 0
mod_fileNames = set()
create_fileNames = set()
delete_fileNames = set()

with open(fileName, 'r') as file: 
    for line in file: 

        if "File Rename: ScapeGoat\\" in line:
            renameCount += 1

        if ("File Modify: ScapeGoat\\") in line: 
            fileName_start = line.find("File Modify: ScapeGoat\\") + len("File Modify: ScapeGoat\\")
            fileName_end = line.find("\n", fileName_start)
            mod_fileNames.add(line[fileName_start:fileName_end])

        if "File Create: " in line: 
            create_fileNames_start = line.find("File Create: ") + len("File Create: ")
            create_fileName_end = line.find("\n", create_fileNames_start)
            create_fileNames.add(line[create_fileNames_start:create_fileName_end])
        elif "File Delete: " in line: 
            delete_fileName_start = line.find("File Delete: ") + len("File Delete: ")
            delete_fileName_end = line.find("\n", create_fileNames_start)
            delete_fileNames.add(line[delete_fileName_start:delete_fileName_end])
common_fileNames = create_fileNames.intersection(delete_fileNames)

# If all three Rules are broken above, prints the following statement
if (renameCount > 3) and (len(mod_fileNames) > 3) and (len(common_fileNames) >= 1):
    print("malware deteced - HEUR:Trojan- Ransom.DocxEncrypt.Generic")